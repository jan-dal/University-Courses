#lang racket

(provide cube-root)

(define (cube-root x)

  (define (abs z)
    (cond [(>= z 0) z]
          [else (- z)]))
  
  (define (better y)
    (/ (+ (/ x (* y y)) (+ y y)) 3))
  
  (define (cube-iter y)
    (if (ok? y) y
        (cube-iter (better y))))
  
  (define (ok? y)
    (< (abs(- (* y y y) x)) 0.001))

  
  (cube-iter 1.0))

(cube-root 8)
(cube-root -64)
(cube-root 121)
(cube-root 4096)
(cube-root 9.78)
