from util import *

e = mpz(3)
n1 = mpz(95039348686345519775275209679375306731181331400983736849866628265918539882878431584564731410028269174710975247507573609448953065487270939628033213887235042801983647671489459697561969403109437524783965328089506131232612946412903557711709359854561944488361470216531319834712066071233170587785911540042579698907)
c1 = mpz(76174535651052895376915037596288799975843956798412006031780298843292094616237720366306716436247685797260757280652298310294169302750087039563420766056095928814587024062955143089455884260193762262828378383495068455325747074488873970178318524145259063288118659857483469331707700010203651514076827618723762827292)

n2 = mpz(169846720658058418687431423689181583299673830839040407270425343986734063775661441155736790210274329505604416327607065676278110759960003084837867904058943249151787127301934269432421739925404782063660583810597248407683051054446632519850093429382809316303964053694266791320108900984949053512746691587527146231979)
c2 = mpz(37675579701159906245501206415596555240149102832105763736083378600977411624967257526032556649820858744741731006616680765006221591658850229788324509534372067253342069914381960782334314885677548034670016093712209217259500726870368385455441122538949740859384811682193117974262341818602594113385283674778199344605)

n3 = mpz(102244507550039456656645173190570708943334197685884371383192712923558342445807322689973254710166190944527879102046797003081197694854020981382005176139867168146519595774281755155629861291513698822164876078375880516360919179979368124916952992010120528518290369464088758038547991458594354151883320702230741407021)
c3 = mpz(62057984030869688007344897545444088014053229140520739023398036549804513554187302368646898163319719487662967854883843708191719446586622128218614823062462620494799562276323459706109603433640902011749478795426087706463227112410824687632610734979910849764856022166871507194913981458497804940452952622970258764222)

n4 = mpz(67191827727309137341573532809939931380368665038072407741205201371709602251718509563825029610455534376814205366654071169399146227164775602405456829446027676217016558670696590007846444036399968841672658346467031116895663131732332376643140855204552240829424609061279841648093389752079212672599318672005545019803)
c4 = mpz(349925902769757579368955715992345345653261340754136885544645232156759010203850439513768374528015628390430399233693780026951526252571933577619906565309621773605869241911042751206769068775473087199765419916308991174126716073655339847152020351507845855505184964971942868288366143998613561012843698502999367778)

n5 = mpz(188623968747499)
c5 = mpz(109688584900477)

#p5, q5 = break_smalln(n5, e, c5)
#print(to_plaintext(decrypt(n5, p5, q5, e, c5)))

#p4, q4 = break_smalln(n4, e, c4)
#print(to_plaintext(decrypt(n4, p4, q4, e, c4)))

p1, q1 = fermat_fact(n1)
print(f"p: {int(p1):.50E}")
print(f"q: {int(q1):.50E}")
print(f"p-q: {int(abs(p1-q1)):.50E}")
print(to_plaintext(decrypt(n1, p1, q1, e, c1)))

#print(break_message(n2, e, c2))

#print(break_small_message(n3, e, c3))

